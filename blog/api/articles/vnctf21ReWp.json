{"title":"vnctf21ReWp","uid":"7b6a6ddcdac946174aca4612b4f02cc3","slug":"vnctf21ReWp","date":"2021-03-17T11:03:13.000Z","updated":"2021-09-28T10:21:53.194Z","comments":true,"path":"api/articles/vnctf21ReWp.json","keywords":null,"cover":null,"content":"<h1 id=\"notsudoku\"><a href=\"#notsudoku\" class=\"headerlink\" title=\"notsudoku\"></a>notsudoku</h1><p>这题是python打包的exe</p>\n<p>首先用pyinstxtractor解包</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">.\\pyinstxtractor.py:86: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#39;s documentation for alternative uses\n  import imp\n[*] Processing .\\notsudoku.exe\n[*] Pyinstaller version: 2.1+\n[*] Python version: 37\n[*] Length of package: 5560832 bytes\n[*] Found 60 files in CArchive\n[*] Beginning extraction...please standby\n[+] Possible entry point: pyiboot01_bootstrap\n[+] Possible entry point: 2\n[*] Found 133 files in PYZ archive\n[*] Successfully extracted pyinstaller archive: .\\notsudoku.exe\n\nYou can now use a python decompiler on the pyc files within the extracted directory</code></pre>\n\n<p>得到主要代码在文件 2 ，把这个文件改名为2.pyc，并复制struct文件的E3前面的内容，然后粘贴到2.pyc的E3前面。接着用uncompyle6反编译成py文件。</p>\n<p>最后改一下变量名，得到的是要解一个五阶幻方。本来有多组解，因为有个校验所以只有唯一解。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import time, sys, hashlib\n\nnum &#x3D; 65\n\n# 124 126\nprint(&#39;welcome baby~ input your flag~:&#39;, end&#x3D;&#39;&#39;)\n\n# 128\nstr1 &#x3D; input()\n\n# 130 132\nprint(&#39;your input is:&#39;, end&#x3D;&#39;&#39;)\nprint(str1)\n\n# 134\nprint(&quot;let&#39;s check......&quot;, end&#x3D;&#39;&#39;)\n\n# 136\ntime.sleep(0.5)\n\n# 138 ~ 146\nlist2 &#x3D; []\nlist2 +&#x3D; [[0 for i in range(5)]]\nlist2 +&#x3D; [[0 for i in range(5)]]\nlist2 +&#x3D; [[0 for i in range(5)]]\nlist2 +&#x3D; [[0 for i in range(5)]]\nlist2 +&#x3D; [[0 for i in range(5)]]\n\n# 148\nif len(str1) % 2 !&#x3D; 0:\n    sys.exit()\nfor i in str1:\n    if ord(i) &gt; 52 or ord(i) &lt; 48: # [0, 4]\n        sys.exit()\n\nx &#x3D; str(hashlib.new(&#39;md5&#39;, bytes((str1), encoding&#x3D;&#39;utf8&#39;)).hexdigest())\nif x[:6] !&#x3D; &#39;e3a912&#39;:\n    sys.exit()\nflag &#x3D; x\n\n# 150\nj &#x3D; 0\na &#x3D; 0\nb &#x3D; 0\nfor i in range(0, len(str1), 2):\n    j +&#x3D; 1\n    a &#x3D; int(str1[i])\n    b &#x3D; int(str1[(i + 1)])\n    list2[a][b] &#x3D; j\n\n# 152\nif list2[0][1] !&#x3D; 24 or list2[4][3] !&#x3D; 2:\n    sys.exit()\nif list2[0][2] !&#x3D; 1 or list2[2][3] !&#x3D; 20:\n    sys.exit()\nif list2[1][0] !&#x3D; 23 or list2[3][4] !&#x3D; 3:\n    sys.exit()\n\n# 154 ~ 162\nfor a in range(0, 5):\n    tnum &#x3D; 0\n    a &#x3D; 0\n    for i in range(5):\n        tnum +&#x3D; cla.list2[a][i]\n\n    if tnum !&#x3D; num:\n        sys.exit()\n\n# 164 ~ 172\nfor b in range(0, 5):\n    tnum &#x3D; 0\n    for i in range(5):\n        tnum +&#x3D; list2[i][b]\n\n    if tnum !&#x3D; num:\n        sys.exit()\n\n# 174 ~ 180\nprint(&#39;Goodjob!&#39;, end&#x3D;&#39;&#39;)\nprint(&#39;The flag is vnctf&#123;&#39;, end&#x3D;&#39;&#39;)\nprint(flag, end&#x3D;&#39;&#39;)\nprint(&#39;&#125;&#39;, end&#x3D;&#39;&#39;)\n\n#182\nsys.exit()</code></pre>\n\n<h1 id=\"FlipGame\"><a href=\"#FlipGame\" class=\"headerlink\" title=\"FlipGame\"></a>FlipGame</h1><p>ida中看到主函数中，有一个16x16的位数组，先是把16进制转10进制，然后翻转上下左右中间。</p>\n<p>解法是暴力搜索第一行的情况，接着对于第i+1行，如果第i行对应位置为0，就在第i+1行的那一位执行翻转操作。这样就能得到解。</p>\n<p>代码的话搜索poj 3279即可，是个noip题目。</p>\n","text":"notsudoku这题是python打包的exe 首先用pyinstxtractor解包 .\\pyinstxtractor.py:86: DeprecationWarning: the imp module is deprecated in favour of importlib...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"CTF","slug":"CTF","count":8,"path":"api/categories/CTF.json"}],"tags":[{"name":"ctf","slug":"ctf","count":8,"path":"api/tags/ctf.json"},{"name":"re","slug":"re","count":11,"path":"api/tags/re.json"},{"name":"wp","slug":"wp","count":7,"path":"api/tags/wp.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#notsudoku\"><span class=\"toc-text\">notsudoku</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#FlipGame\"><span class=\"toc-text\">FlipGame</span></a></li></ol>","author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"hgame21","uid":"bc0ff34ebb27f27dad44c564d61b2fb3","slug":"hgame21","date":"2021-03-17T12:51:25.000Z","updated":"2021-09-28T10:21:44.929Z","comments":true,"path":"api/articles/hgame21.json","keywords":null,"cover":null,"text":"web week1智商检测鸡（150）我用的python requests+beautifulsoup。 这题是通过cookie当作账号，做出一题就会给出下一个cookie。 import requests from bs4 import BeautifulSoup import...","link":"","photos":[],"count_time":{"symbolsCount":"7.9k","symbolsTime":"7 mins."},"categories":[{"name":"CTF","slug":"CTF","count":8,"path":"api/categories/CTF.json"}],"tags":[{"name":"ctf","slug":"ctf","count":8,"path":"api/tags/ctf.json"},{"name":"re","slug":"re","count":11,"path":"api/tags/re.json"},{"name":"pwn","slug":"pwn","count":2,"path":"api/tags/pwn.json"},{"name":"misc","slug":"misc","count":2,"path":"api/tags/misc.json"},{"name":"wp","slug":"wp","count":7,"path":"api/tags/wp.json"},{"name":"web","slug":"web","count":1,"path":"api/tags/web.json"}],"author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"远程线程注入逆向","uid":"8974ac6b1252ccb40492ca6fb37e2ab1","slug":"dllRemoteInject","date":"2021-03-16T09:08:49.000Z","updated":"2021-09-28T10:21:35.600Z","comments":true,"path":"api/articles/dllRemoteInject.json","keywords":null,"cover":[],"text":"远程线程注入逆向资料MSDN中的函数定义OpenProcess (processthreadsapi.h) SyntaxHANDLE OpenProcess ( DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcess...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"Windows","slug":"Windows","count":19,"path":"api/categories/Windows.json"}],"tags":[{"name":"windows","slug":"windows","count":19,"path":"api/tags/windows.json"},{"name":"dll","slug":"dll","count":4,"path":"api/tags/dll.json"},{"name":"note","slug":"note","count":25,"path":"api/tags/note.json"}],"author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}