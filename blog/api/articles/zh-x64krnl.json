{"title":"B站x64内核笔记1","uid":"368d5d02963b1ddd739fe7288ce34859","slug":"zh-x64krnl","date":"2022-05-17T04:00:00.000Z","updated":"2022-09-26T10:26:34.355Z","comments":true,"path":"api/articles/zh-x64krnl.json","keywords":null,"cover":null,"content":"<h2 id=\"IA-32e\"><a href=\"#IA-32e\" class=\"headerlink\" title=\"IA_32e\"></a>IA_32e</h2><p><strong>Extended Feature Enable Register（IA32_EFER，MSR[0xC0000080]）</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>vol-3a p69 2.2.1 Extended Feature Enable Register</p></blockquote>\n<p>![](E:\\documents\\note\\md\\windows\\sdm-figure\\vol-3a-f-2-4 IA32_EFER MSR Layout.png)<br>第8位为1 就处于IA-32e模式</p>\n<p>[windbg]<code>rdmsr C0000080</code></p>\n<h2 id=\"GDT\"><a href=\"#GDT\" class=\"headerlink\" title=\"GDT\"></a>GDT</h2><p><strong>x64 CS描述符</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>vol-3a p161 5.2.1 Code-Segment Descriptor in 64-bit Mode</p></blockquote>\n<p>![](E:\\documents\\note\\md\\windows\\sdm-figure\\vol-3a-f-5-2 Descriptor Fields with Flags used in IA-32e Mode.png)</p>\n<p>第12位（S）：1=DS/CS</p>\n<p>第11位（Type的第3位）：0=DS，1=CS</p>\n<p>当处于IA-32e模式：</p>\n<table>\n<thead>\n<tr>\n<th>CS.D(22)</th>\n<th>CS.L(21)</th>\n<th>bit</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>0</td>\n<td>0</td>\n<td>16</td>\n</tr>\n<tr>\n<td>1</td>\n<td>0</td>\n<td>32</td>\n</tr>\n<tr>\n<td>0</td>\n<td>1</td>\n<td>64</td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>#GP fault</td>\n</tr>\n</tbody></table>\n<p><strong>gdt</strong></p>\n<p>段选择子（清掉低3位）刚好是相对gdtr的偏移</p>\n<p>D L(G,D,L,AVL)，DPL(P,DPL, 1) ，Type(1,C,R,A)</p>\n<table>\n<thead>\n<tr>\n<th>段选择子</th>\n<th>index</th>\n<th>D L</th>\n<th>DPL</th>\n<th>Type</th>\n<th>Flags</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>10</td>\n<td>2</td>\n<td>x64(0010)</td>\n<td>R0(1001)</td>\n<td>Code(1011)</td>\n<td>29b</td>\n</tr>\n<tr>\n<td>18</td>\n<td>3</td>\n<td></td>\n<td>R0(1001)</td>\n<td>Data(0011)</td>\n<td>493</td>\n</tr>\n<tr>\n<td>20</td>\n<td>4</td>\n<td>x32(1100)</td>\n<td>R3(1111)</td>\n<td>Code(1011)</td>\n<td>cfb</td>\n</tr>\n<tr>\n<td>28</td>\n<td>5</td>\n<td></td>\n<td>R3(1111)</td>\n<td>Data(0011)</td>\n<td>cf3</td>\n</tr>\n<tr>\n<td>30</td>\n<td>6</td>\n<td>x64(0010)</td>\n<td>R3(1111)</td>\n<td>Code(1011)</td>\n<td>2fb</td>\n</tr>\n<tr>\n<td>38</td>\n<td>7</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>NULL</td>\n</tr>\n</tbody></table>\n<p>[gdtr+0x40] = TSS</p>\n<p><strong>对比x32的描述符</strong></p>\n<p>cs、ds使用64位描述符，强制平坦（段描述符基址永远是0，界限永远是最大）</p>\n<p>32位的基址、界限等信息在64位中不再保留</p>\n<p>[windbg]<code>dq gdtr</code></p>\n<p>[windbg]<code>dg [off]</code>：解析<code>gdtf+off</code>处的描述符（按64位解析）</p>\n<p><strong>tss段描述符 和 tss</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>vol-3a p256 7.2.3 TSS Descriptor in 64-bit mode</p></blockquote>\n<p>![](E:\\documents\\note\\md\\windows\\sdm-figure\\vol-3a-f-7-4 Format of TSS and LDT Descriptors in 64-bit Mode.png)</p>\n<p>tss段描述符拓展到128位</p>\n<p>![](E:\\documents\\note\\md\\windows\\sdm-figure\\vol-3a-f-7-11 64-Bit TSS Format.png)</p>\n<h2 id=\"IDT\"><a href=\"#IDT\" class=\"headerlink\" title=\"IDT\"></a>IDT</h2><p><strong>x64 IDT</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>vol-3a p211 6.14.1 64-Bit Mode IDT</p></blockquote>\n<p>![](E:\\documents\\note\\md\\windows\\sdm-figure\\vol-3a-f-6-8 64-Bit IDT Gate Descriptors.png)</p>\n<p>中断描述符拓展到128位</p>\n<p><code>idt</code>表项的<code>ist</code>项选择使用tss中哪个rsp<br>比如<code>idt-&gt;ist=1</code>，使用的是<code>rsp=tss.ist1</code></p>\n<p>[windbg]<code>idt</code>：查看所有中断</p>\n<p>[windbg]<code>dq idtr</code>：查看中断描述符表idt</p>\n<h2 id=\"切换\"><a href=\"#切换\" class=\"headerlink\" title=\"切换\"></a>切换</h2><p><strong>r3进r0</strong></p>\n<p>IA32_FS_BASE MSR[0xC0000100]</p>\n<p>IA32_GS_BASE MSR[0xC0000101]，当前GS（R3指向teb、R0指向kprc）</p>\n<p>IA32_KERNEL_GS_BASE MSR[0xC0000102]，（R3指向kprc、R0指向teb）</p>\n<p>gs r3指向teb，r0切换为kprc，<code>swapgs</code>，切换<code>IA32_GS_BASE</code> 和<code>IA32_KERNEL_GS_BASE</code></p>\n<p><strong>系统调用</strong></p>\n<ul>\n<li>x64内核<ul>\n<li>x64程序 syscall sysret</li>\n<li>x32程序 r3转64</li>\n</ul>\n</li>\n<li>x32内核<ul>\n<li>sysentry</li>\n</ul>\n</li>\n</ul>\n<p><strong>x32转x64</strong></p>\n<p>ntdll的切换方式（系统调用时）：改变cs</p>\n<p>x32切换cs，0x0023（x32_R3_Code）变0x0033（x64_R3_Code）</p>\n<pre class=\"line-numbers language-assembly\" data-language=\"assembly\"><code class=\"language-assembly\">jmp far 33:00000000 ; (7) EA 00000000 3300</code></pre>\n\n<p>x64回x32（tword 10字节）</p>\n<pre class=\"line-numbers language-assembly\" data-language=\"assembly\"><code class=\"language-assembly\">; tword ptr [rax] &#x3D; 00000000 00000000 2300\njmp far tword ptr ds:[rax] ; (3) 48 FF28</code></pre>\n\n\n\n<p>win10 x32程序会初始化r15、r14、r13，在切换到x64后（进入r0之前）使用</p>\n<p>x32程序可以在r12等切换不会用到的x64寄存器中藏数据</p>\n<h2 id=\"SMEP和SMAP\"><a href=\"#SMEP和SMAP\" class=\"headerlink\" title=\"SMEP和SMAP\"></a><strong>SMEP和SMAP</strong></h2><p>三重错误会直接关机，不会蓝屏，也不会被windbg捕获</p>\n<p>cr4标志位</p>\n<p>[20] SMEP：r0不能执行r3代码页</p>\n<p>[21] SMAP：r0不能读写r3内存页</p>\n<p>可以通过修改cr4关闭这两个保护，也可以通过汇编指令绕过SMAP(内核int3中断例程的做法)：</p>\n<p>stac作用是设置RFLAGS的AC标志，使得r0可以读写r3</p>\n<p>clac清楚AC标志</p>\n<pre class=\"line-numbers language-assembly\" data-language=\"assembly\"><code class=\"language-assembly\">stac ; 0f 01 CB</code></pre>\n\n<p>此时(中断进r0，执行r3代码页)可以读写r0的：GDT、IDT、KVASCODE</p>\n<p>读写r0其他的节会三重异常</p>\n<h2 id=\"分页（pass）\"><a href=\"#分页（pass）\" class=\"headerlink\" title=\"分页（pass）\"></a>分页（pass）</h2><p>参照别的笔记</p>\n<h2 id=\"KPTI\"><a href=\"#KPTI\" class=\"headerlink\" title=\"KPTI\"></a>KPTI</h2><p>视频的实验结果：</p>\n<p>刚进int例程时打印的，exe的user cr3=4<br>windbg看到的r3程序的，exe的kernel cr3=2，对r3代码页pml4e没有可执行标志</p>\n<p>使用cr3=4，转换<code>(ntoskrnl.exe)KVASCODE</code>的地址，能得到正确结果<br>使用cr3=4，转换<code>(ntoskrnl.exe).text</code>，pde=0<br>使用cr3=2，转换<code>(ntoskrnl.exe).text</code>，能得到正确结果</p>\n<p>导致r0下不能执行r3代码的两个机制：</p>\n<ul>\n<li>开启smep，r0权限不能执行r3代码页</li>\n<li>切换到kernel的cr3，默认对r3代码页没有可执行标志（user cr3没有映射完整的内核）</li>\n</ul>\n<p>user cr3映射的区域：user space(RWE)、KVASCODE(RE)、GDT/IDT(RW)</p>\n<p>kernel cr3映射的区域：user space(没有E)、完整kernel space</p>\n<p>symbol type viewer可以把pdg转成.h，ida中可以prase c解析.h的结构体</p>\n<h2 id=\"硬件漏洞-CFG\"><a href=\"#硬件漏洞-CFG\" class=\"headerlink\" title=\"硬件漏洞 CFG\"></a>硬件漏洞 CFG</h2><p><strong>幽灵熔断</strong></p>\n<p>乱序执行对应的利用即为 Meltdown（熔断） ，而预测执行对应的利用即为 Spectre（幽灵）</p>\n<p><strong>lfence指令</strong></p>\n<p>保证读操作串行化</p>\n<p>KiBreapPoint中的补丁代码：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">; ...\n0x00000000   4                 4883c408  add rsp, 8\n0x00000004   5               e8eeffffff  call 0xfffffffffffffff7\n0x00000009   4                 4883c408  add rsp, 8\n0x0000000d   5               e8eeffffff  call 0\n0x00000012   4                 4883c408  add rsp, 8\n0x00000016   5               e8eeffffff  call 9\n0x0000001b   4                 4883c408  add rsp, 8\n0x0000001f   5               e8eeffffff  call 0x12\n; ...\n0x????????                     4883c408  add rsp, 8</code></pre>\n\n<p><code>add rsp</code>相当于pop，连续的pop call，使rip上移，最后一个call会去到最下面，整段nop掉不会影响结果，只是用来修补硬件漏洞</p>\n<p><strong>控制流保护（CFG）</strong></p>\n<p><code>call _guard_dispatch_icall </code>等价于<code>call rax</code></p>\n","text":"IA_32eExtended Feature Enable Register（IA32_EFER，MSR[0xC0000080]） vol-3a p69 2.2.1 Extended Feature Enable Register ![](E:\\documents\\note\\md...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"Windows","slug":"Windows","count":21,"path":"api/categories/Windows.json"}],"tags":[{"name":"windows","slug":"windows","count":21,"path":"api/tags/windows.json"},{"name":"note","slug":"note","count":27,"path":"api/tags/note.json"},{"name":"kernel","slug":"kernel","count":7,"path":"api/tags/kernel.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#IA-32e\"><span class=\"toc-text\">IA_32e</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#GDT\"><span class=\"toc-text\">GDT</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#IDT\"><span class=\"toc-text\">IDT</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%87%E6%8D%A2\"><span class=\"toc-text\">切换</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SMEP%E5%92%8CSMAP\"><span class=\"toc-text\">SMEP和SMAP</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%86%E9%A1%B5%EF%BC%88pass%EF%BC%89\"><span class=\"toc-text\">分页（pass）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#KPTI\"><span class=\"toc-text\">KPTI</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A1%AC%E4%BB%B6%E6%BC%8F%E6%B4%9E-CFG\"><span class=\"toc-text\">硬件漏洞 CFG</span></a></li></ol>","author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"B站x64内核笔记2 PG","uid":"6b5e22753329d2c346dcd0a78d93034d","slug":"zh-patchguard","date":"2022-07-06T04:00:00.000Z","updated":"2022-09-26T10:27:16.767Z","comments":true,"path":"api/articles/zh-patchguard.json","keywords":null,"cover":null,"text":"PatchGuardStep 1 设 BigPool 不可执行编写一个驱动，遍历BigPool信息，将可疑的BigPool设置为不可执行，等待蓝屏 然后分析蓝屏信息得到context入口点，简要分析context入口点 1 查询所有BigPool使用ZwQuerySystemIn...","link":"","photos":[],"count_time":{"symbolsCount":"9k","symbolsTime":"8 mins."},"categories":[{"name":"Windows","slug":"Windows","count":21,"path":"api/categories/Windows.json"}],"tags":[{"name":"windows","slug":"windows","count":21,"path":"api/tags/windows.json"},{"name":"note","slug":"note","count":27,"path":"api/tags/note.json"},{"name":"kernel","slug":"kernel","count":7,"path":"api/tags/kernel.json"}],"author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SFU Compilers class 笔记3","uid":"a1035c3663b3c14e4c1a5b534fff7e3d","slug":"SFU-Compilers-3","date":"2022-05-09T04:00:00.000Z","updated":"2024-01-05T07:02:49.083Z","comments":true,"path":"api/articles/SFU-Compilers-3.json","keywords":null,"cover":[],"text":"SFU Compilers 笔记 3 语法分析1week4 p:yacc week5 week6 Week 4 Context-Free Grammars（lost）CFG1 Intro to CFGs一个CFG包括： 终止符集合：T（输入符号） 非终止符集合：N 开始符号：S ...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[{"name":"CS","slug":"CS","count":6,"path":"api/categories/CS.json"}],"tags":[{"name":"note","slug":"note","count":27,"path":"api/tags/note.json"},{"name":"cs","slug":"cs","count":6,"path":"api/tags/cs.json"},{"name":"compiler","slug":"compiler","count":6,"path":"api/tags/compiler.json"}],"author":{"name":"御史神风","slug":"御史神风","avatar":"/blog/imgs/child.jpg","link":"/","description":"芜湖~好耶!","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}